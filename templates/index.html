<!DOCTYPE html>
<html>
  <head>
    <title>LNURLp chatbot</title>
  </head>
  <body>
    <center>
      <small id="error"></small>
      <br /><br /><br /><br />
      <div id="messages"></div>
      <div
        id="qrcode"
        style="position: absolute; bottom: 10px; width: 100%"
      ></div>
    </center>

    <script>
      // ADD YOUR LNURL-PAY LINK HERE //
      var LNURL =
        "LNURL1DP68GURN8GHJ7MRWVF5HGUEWVDHK6TMVDE6HYMRS9ASHQ6F0WCCJ7MRWW4EXCTE3XQUQKKF3P0";
      //////////////////////////////////

      var source = new EventSource("{{ url_for('sse.stream') }}");
      var messagearray = [];
      var colourarray = ["#ccffff", "#66ccff", "#3399ff", "#0066ff", "#0000ff"];
      var messagestr = "";
      document.getElementById("qrcode").innerHTML =
        "<img src='/qr/" + LNURL + "'>";
      source.addEventListener(
        "greeting",
        function (event) {
          var data = JSON.parse(event.data);
          //messagearray.pop();
          var messagetemp = data.message;
          console.log(messagetemp);
          messagearray.push(messagetemp);
          for (i = 0; i < 3; i++) {
            messagestr +=
              "<h1 style='font-size:50px;'>" + messagearray[i] + "</h1>";
          }
          document.getElementById("messages").innerHTML = messagestr;
        },
        false
      );
      source.addEventListener(
        "error",
        function (event) {
          document.getElementById("error").innerHTML =
            "Failed to connect to event stream. Is Redis running?";
        },
        false
      );
    </script>
  </body>
</html>
